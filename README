Скрипт загружает метаинформацию о rpm пакетах в базу данных.


Зависимости:
    python3-module-rpm
    python3-module-clickhouse-driver
    python3-module-pycdlib
    python3-module-requests


Файлы:
    extract.py - Скрипт отвечающий за загрузку репозитория
    mapper.py - Функции для конвертации данных
    utils.py - Вспомогательные функции
    task.py - Скрипт отвечающий за загрузку сборочного задания
    bugzilla.py - Скрипт загрузки информации о багах в БД
    repocop.py - Скрипт загрузки отчета Repocop в БД
    beehive.py - Скрипт загрузка результатов пересборки из Beehive в БД
    sql/* - Sql файлы структуры базы данных
    config.ini.example - Пример файла конфигурации


Устройство базы данных:
### ВНИМАНИЕ ###
В папке sql под порядковым номером и именем хранится история изменений схемы 
базы данных проекта.

0000_initial.sql - последняя версия струтуры БД

Инициализация структуры БД:

    cat sql/0000_initial.sql | clickhouse-client -h 10.88.13.52 -d repodb -n

Загрузка данных в CveChecked:

    cat sql/CveChecked-initial.json | clickhouse-client  -h 10.88.13.52 -d repodb --query="INSERT INTO CveChecked FORMAT JSONEachRow"

Загрузка данных в License Aliases:

    cat sql/license_aliases.json | clickhouse-client  -h 10.88.13.52 -d repodb2 --query="INSERT INTO LicenseAliases FORMAT JSONEachRow"


Аргументы запуска extract.py:
    pkgset - обязательный позиционный аргумент. например: p9 или sisyphus или c8.1
    path - обязательный позиционный аргумент. путь к rpm файлам например /mnt/repo/Sisyphus/files/ или файл iso образа
    -t, --tag - дополнительное информационное поле в таблице PackageSetNames
    -A, --date - позволяет указать конкретную дату для pkgset
    -c, --config - путь к файлу конфигурации
    -d, --dbname - имя базы данных
    -s, --host - хост базы данных 
    -p, --port - порт базы данных 
    -u, --user - имя пользователя базы данных 
    -P, --password - пароль пользователя базы данных 
    -w, --workers - количество потоков 
    -D, --debug - включает вывод отладочной информации в лог файл
    -T, --timing - включать в лог время исполнения функций
    -v, --verbose - выводить промежуточный результат загрузки
    -F, --force - загрузка репозитория вне зависимости от наличия репозитория с таким именем и датой в БД 
    -h, --help - вызов справки


Примеры запуска:
    * extract.py:
        python3 extract.py p10 /archive/repo/p10/date/2021/08/18 --date 2021-08-18 -s localhost -d repodb -w 10 --tag test_load -T -v
        python3 extract.py sisyphus /archive/repo/sisyphus/date/2021/08/18 --date 2021-08-18 -c config.ini --tag team_load -T -v
    
    * task.py:
        python3 task.py /archive/tasks/done/_276/283337 -c config.ini -D -w 10
    
    * bugzilla.py:
        python3 bugzilla.py -c config.ini
        python3 bugzilla.py --host 10.88.13.52 --dbname repodb

    * repocop.py:
        python3 repocop.py -c config.ini
        python3 repocop.py --host 10.88.13.52 --dbname repodb --user test --password supersecret

    * beehive.py:
        python3 beehive.py -c config.ini
        python3 beehive.py --host 10.128.7.72 --dbname repodb --user test --password supersecret
